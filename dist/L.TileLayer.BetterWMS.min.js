L.TileLayer.BetterWMS=L.TileLayer.WMS.extend({onAdd:function(n){L.TileLayer.WMS.prototype.onAdd.call(this,n);n.on("click",this.getFeatureInfo,this)},onRemove:function(n){L.TileLayer.WMS.prototype.onRemove.call(this,n);n.off("click",this.getFeatureInfo,this)},getFeatureInfo:function(n){var i=this.getFeatureInfoUrl(n.latlng),t=L.Util.bind(this.showGetFeatureInfo,this);$.ajax({url:i,success:function(i){var r=typeof i=="string"?null:i;t(r,n.latlng,i)},error:function(n,i,r){t(r)}})},getFeatureInfoUrl:function(n){var i=this._map.latLngToContainerPoint(n,this._map.getZoom()),r=this._map.getSize(),t={request:"GetFeatureInfo",service:"WMS",srs:"EPSG:4326",styles:this.wmsParams.styles,transparent:this.wmsParams.transparent,version:this.wmsParams.version,format:this.wmsParams.format,bbox:this._map.getBounds().toBBoxString(),height:r.y,width:r.x,layers:this.wmsParams.layers,query_layers:this.wmsParams.layers,info_format:"text/html"};return t[t.version==="1.3.0"?"i":"x"]=i.x,t[t.version==="1.3.0"?"j":"y"]=i.y,this._url+L.Util.getParamString(t,this._url,!0)},showGetFeatureInfo:function(n,t,i){if(n){console.log(n);return}L.popup({maxWidth:800}).setLatLng(t).setContent(i).openOn(this._map)}});L.tileLayer.betterWms=function(n,t){return new L.TileLayer.BetterWMS(n,t)};
/*
//# sourceMappingURL=L.TileLayer.BetterWMS.min.js.map
*/
